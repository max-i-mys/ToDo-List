(this["webpackJsonpmax-react"]=this["webpackJsonpmax-react"]||[]).push([[0],[,,,,,,,,,,,,,,function(t,e,n){},function(t,e,n){},,,function(t,e,n){},function(t,e,n){},function(t,e,n){},function(t,e,n){"use strict";n.r(e);var r=n(1),c=n.n(r),a=n(9),s=n.n(a),o=(n(14),n(15),n(2)),i=n.n(o),u=n(4),d=n(3);function p(t,e){return l.apply(this,arguments)}function l(){return(l=Object(u.a)(i.a.mark((function t(e,n){var r,c;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(e,n);case 3:if((r=t.sent).ok){t.next=6;break}throw new Error("Response error. Status ->> ".concat(r.status));case 6:return t.next=8,r.json();case 8:return c=t.sent,t.abrupt("return",c);case 12:t.prev=12,t.t0=t.catch(0),console.warn(t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})))).apply(this,arguments)}function j(t,e,n){var r={method:"POST",body:JSON.stringify(n),headers:{"Content-type":"application/json; charset=UTF-8"}};return p("".concat(t,"/").concat(e),r)}function f(t,e,n,r){var c={method:"PATCH",body:JSON.stringify(r),headers:{"Content-type":"application/json; charset=UTF-8"}};return p("".concat(t,"/").concat(e,"/").concat(n),c)}function b(t,e,n){return p("".concat(t,"/").concat(e,"/").concat(n),{method:"DELETE"})}var h="http://localhost:3004",O=n(7),x=n(0),m=[],y=Object(r.createContext)();function v(t){var e=t.children,n=Object(r.useReducer)((function(t,e){switch(e.type){case"INITIAL":return e.payload;case"ADD":return[].concat(Object(O.a)(t),[e.payload]);case"UPDATE":var n=JSON.parse(JSON.stringify(Object(O.a)(t))),r=n.findIndex((function(t){return t.id===e.payload.id}));return n.splice(r,1,e.payload),n;case"DELETE":var c=JSON.parse(JSON.stringify(Object(O.a)(t))),a=c.findIndex((function(t){return t.id===e.payload}));if(console.log(e.payload),-1===a)throw new Error("In ".concat(e.type," wrong todo.id"));return c.splice(a,1),c;default:throw new Error("Wrong action type: ".concat(e.type))}}),m),c=Object(d.a)(n,2),a=c[0],s=c[1];return Object(r.useEffect)((function(){Object(u.a)(i.a.mark((function t(){var e;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n="todos",p("".concat(h,"/").concat(n));case 2:e=t.sent,s({type:"INITIAL",payload:e});case 4:case"end":return t.stop()}var n}),t)})))()}),[]),Object(x.jsx)(y.Provider,{value:[a,s],children:e})}function w(){return Object(r.useContext)(y)}n(18);function _(){var t=Object(r.useState)(""),e=Object(d.a)(t,2),n=e[0],c=e[1],a=Object(r.useState)(),s=Object(d.a)(a,2),o=s[0],p=s[1],l=w(),f=Object(d.a)(l,2)[1];function b(){return(b=Object(u.a)(i.a.mark((function t(e){var r,c;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),r={title:n,body:o,createdAt:Date.now(),processAt:!1,finishedAt:!1,status:"new"},t.next=4,j(h,"todos",r);case 4:c=t.sent,f({type:"ADD",payload:c}),e.target.reset();case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(x.jsxs)("form",{onSubmit:function(t){return b.apply(this,arguments)},className:"todo__add",children:[Object(x.jsx)("input",{className:"todo__add-title",type:"text",onChange:function(t){return c((function(){return t.target.value}))},name:"title",required:!0}),Object(x.jsx)("textarea",{className:"todo__add-body",name:"body",onChange:function(t){return p((function(){return t.target.value}))},required:!0,minLength:"10"}),Object(x.jsx)("button",{type:"submit",className:"todo__btn",children:"Add"})]})}n(19);function A(t){switch(t){case"new":return"process";case"process":default:return"finished"}}var N=new Intl.DateTimeFormat("ru",{day:"numeric",month:"2-digit",year:"2-digit",hour:"numeric",minute:"numeric"});n(20);function g(t){var e=w(),n=Object(d.a)(e,2)[1];function r(){return(r=Object(u.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b(h,"todos",t.id);case 2:e.sent&&n({type:"DELETE",payload:t.id});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(x.jsx)(x.Fragment,{children:Object(x.jsx)("button",{onClick:function(){return r.apply(this,arguments)},className:"todo__close-btn",children:"Del"})})}function D(t){var e=t.todo,n=w(),r=Object(d.a)(n,2)[1];function c(){return(c=Object(u.a)(i.a.mark((function t(){var n,c;return i.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((n=A(e.status))===e.status){t.next=6;break}return t.next=4,f(h,"todos",e.id,{status:n,processAt:"process"===n?Date.now():e.processAt,finishedAt:"finished"===n?Date.now():e.finishedAt});case 4:c=t.sent,r({type:"UPDATE",payload:c});case 6:case"end":return t.stop()}}),t)})))).apply(this,arguments)}return Object(x.jsx)(x.Fragment,{children:Object(x.jsxs)("div",{onDoubleClick:function(){return c.apply(this,arguments)},className:"todo__task ".concat(e.status),children:[Object(x.jsx)("h4",{className:"todo__title",children:e.title}),Object(x.jsx)(g,{id:e.id}),Object(x.jsx)("p",{className:"todo__body",children:e.body}),Object(x.jsxs)("div",{className:"todo__info",children:[Object(x.jsx)("span",{children:e.status}),Object(x.jsxs)("div",{className:"todo__time",children:[Object(x.jsxs)("p",{children:["Create: ",N.format(e.createdAt)]}),e.processAt&&Object(x.jsxs)("p",{children:["Process: ",N.format(e.processAt)]}),e.finishedAt&&Object(x.jsxs)("p",{children:["Finished: ",N.format(e.finishedAt)]})]})]})]})})}function E(){var t=w(),e=Object(d.a)(t,1)[0];return Object(x.jsx)(x.Fragment,{children:e&&Object(x.jsx)("div",{className:"todo__box",children:e.map((function(t){return Object(x.jsx)(D,{todo:t},t.id)}))})})}var k=function(){return Object(x.jsxs)("div",{className:"App",children:[Object(x.jsx)(E,{}),Object(x.jsx)(_,{})]})};s.a.render(Object(x.jsx)(c.a.StrictMode,{children:Object(x.jsx)(v,{children:Object(x.jsx)(k,{})})}),document.getElementById("root"))}],[[21,1,2]]]);
//# sourceMappingURL=main.1b83751b.chunk.js.map